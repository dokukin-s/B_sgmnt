Первоначально алгоритм был реальзован в виде последовательного сканирования 
изображения сверху вниз,слева на право и обратного сканирования снизу вверх
справа на лево,занесения меток пикселей в матрицу,потом сканирование этой матрицы,присваивания новых меток и объединения имеющихся и т.д.
но почти сразу выяснилось что он совершенно не эффективен при 
работе с тестовыми изображениями большого разрешения(которые я выбрал не посмотрев на размер),
даже изображения размером 300*300 обрабатывалось очень долго 

потом я попытался арганизовать массив эквивалентностей для хранения эквивалентных меток у соседних пикселей,чтобы в дальнейшем 
было просто их переприсваивать, стал вопрос о том как лучше все это реализовать и я нашел решение в виде системы непересекающихся
множеств, которая была реализованна

http://e-maxx.ru/algo/dsu